---
layout: post
title: Java Web Application with Embedded Tomcat
date: 2018-08-31
description: This tutorial is to create a Java web application using embedded Apache Tomcat web server.
keywords: Java, Tomcat, Embedded
---

<h3>Purpose</h3>
<p>This is to create a web application in Java. The Apache Tomcat will be emddeded to the JAR (not WAR), called uber/fat JAR. Other dependencies, if there is any, will also be included.</p>
<p>We will create a page with the following URL:</p>
<code>http://localhost:8080/java-web-app-with-embedded-tomcat/hello</code>
<br><br>
<p>This page will display a form with two inputs, <span class="font-italic">name</span> and <span class="font-italic">message</span>. When submitted, it will display the message and name on the same page.</p>
<h3>Requirements</h3>
<ul>
    <li>JDK 8</li>
    <li>Maven</li>
    <li>an IDE - Eclipse (Or NetBeans, Intellij IDEA, if you prefer)</li>
</ul>
</h3>
<h3>Build with Maven</h3>
<p>First, we'll create a Java Maven project. Open your terminal and cd to your preferred workspace and run the following commands:</p>
<pre>
mkdir java-web-app-with-embedded-tomcat
cd java-web-app-with-embedded-tomcat
mkdir -p src/main/java/io/github/julinjupiter/app
mkdir src/main/resources
mkdir -p src/main/webapp/WEB-INF
touch pom.xml
</pre>
<p><strong>Note:</strong> you can choose your own package instead of <span class="font-italic">io/github/julianjupiter/app</span> (<span class="font-italic">io.github.julinjupiter.app</span>)</p>
<p>The project structure should now be:</p>
<pre>
java-web-app-with-embedded-tomcat
└── src
    └── main
        └── java
            └── io
                └── github
                    └── julianjupiter
                        └── app
        └── resources
        └── webapp
            └── WEB-INF
└── pom.xml
</pre>
<p>Open <span class="font-weight-bold">pom.xml</span> using your favorite editor (mine is <a href="https://code.visualstudio.com" target="_blank">Visual Studio Code</a>). Copy and paste the following XML.</p>
<script src="http://gist-it.appspot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/pom.xml"></script>
<p>
Take note that our <span class="font-weight-bold">packaging</span> is jar</span> and we are using <span class="font-weight-bold">Maven Shade Plugin</span> here to package our application into JAR. From its website, it reads: <span class="font-italic">This plugin provides the capability to package the artifact in an uber-jar, including its dependencies and to shade - i.e. rename - the packages of some of the dependencies.</span>
</p>
<p>Another thing worth to mention is the <span class="font-weight-bold">mainClass</span> tag where we define our class with <span class="font-weight-bold font-italic">main</span> method.</p>
<p>Lastly, we include at least two dependencies for embedding Tomcat: <span class="font-italic">tomcat-embed-core</span>, <span class="font-italic">tomcat-embed-jasper</span>.</p>
<h3>Import to Eclipse</h3>
<p>To import the project:<p>
<p class="font-italic">Eclipse - File > Import... > Maven > Existing Maven Projects > Browse ... (for Root Directory) > Finish</p>
<h3>Let's Start Coding</h3>
<h4>Server</h4>
<p>Create a package <span class="font-weight-bold font-italic">server</span> under <span class="font-weight-bold font-italic">app</span>. Under this package, we will have an interface <span class="font-weight-bold font-italic">Server</span> and class <span class="font-weight-bold font-italic">TomcatServer</span>. The interface will have one abstract method, <span class="font-weight-bold font-italic">run</span> which will serve as entry point to start our Tomcat server. This opens a possibility to add more servers other than Tomcat, either from scratch or use existing ones (Jetty, Undertow).</p>
<h5>Server.java</h5>
<script src="http://gist-it.appspot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/server/Server.java"></script>
<h5>TomcatServer.java</h5>
<script src="http://gist-it.appspot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/server/TomcatServer.java"></script>
<h5>Main.java</h5>
<p>We will now create our main class as defined by <span class="font-weight-bold">mainClass</span> in pom.xml.</p>
<p>As this class contains <span class="font-weight-bold font-italic">main</span> method, this will serve as entry point to start our application and the server. Here, we instantiate the <span class="font-weight-bold font-italic">TomcatServer</span> class and call <span class="font-weight-bold font-italic">run</span> method. We pass in <span class="font-weight-bold font-italic">args</span> argument from <span class="font-weight-bold font-italic">main</span> method to <span class="font-weight-bold font-italic">run</span> method. By default, the server will listen on port <span class="font-weight-bold font-italic">8080</span> but we can override it by passing desired port number to our <span class="font-weight-bold font-italic">main</span> method. This is optional, though (stick to 8080).</p>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/Main.java"></script>
<p>With the codes above, we can now build and run our application, but since there is no Servlet handler or default JSP page, it will just error page.</p>
<p>To test our application, create a <span class="font-weight-bold font-italic">index.jsp</span> file inside <span class="font-weight-bold font-italic">webapp</span> folder.</p>
<pre>
    <code class="language-markup">
        <script type="prism-html-markup">
        <%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
        <!DOCTYPE html>
        <html>
            <head>
                <meta charset="UTF-8">
                <title>Java Web Application with Embedded Tomcat</title>
            </head>
            <body>
                <h1>Hello, world!</h1>
            </body>
        </html>
        </script>
    </code>
</pre>
<p>To build and run the application, run the following commands under the root directory of the project:</p>
<pre>
mvn package
java -jar ./target/java-web-app-with-embedded-tomcat-1.0.0-SNAPSHOT.jar
</pre>
<p>If the application starts successfully, open your browser: <a href="http://localhost:8080/app">http://localhost:8080/app</a>.</p>
<p><img class="img-fluid" src="/assets/images/java-web-application-with-embedded-tomcat/1.PNG"></p>
<h3>Add Servlet, JSPs and Other Classes</h3>
<h4>Domain</h4>
<h5>Book.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/domain/Book.java"></script>
<h4>Repository</h4>
<h5>BookRepository.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/repository/BookRepository.java"></script>
<h5>BookRepositoryImpl.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/repository/BookRepositoryImpl.java"></script>
<h4>Service</h4>
<h5>BookService.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/service/BookService.java"></script>
<h5>BookServiceImpl.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/service/BookServiceImpl.java"></script>
<h4>Controller</h4>
<h5>BaseController.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/controller/BaseController.java"></script>
<h5>BookController.java</h5>
<script src="http://gist-it.appshot.com/https://github.com/julianjupiter/java-web-app-with-embedded-tomcat/blob/master/src/main/java/io/github/julianjupiter/app/controller/BookController.java"></script>

<p>To be continued...</p>