<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="author" content="Julian Jupiter"/><meta name="description" content="This tutorial is to create a Java web application using embedded Apache Tomcat web server."/><meta name="keywords" content=""/><title>Julian Jupiter - Blog - Java Web Application with Embedded Tomcat</title><link rel="shortcut icon" href="/assets/images/favicon.PNG"/><link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&amp;display=swap" rel="stylesheet"/><link href="/assets/vendor/prismjs/themes/prism-tomorrow.css" rel="stylesheet"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/bfc8cab2af74749035f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bfc8cab2af74749035f1.css"/><link rel="preload" href="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/pages/blog/%5Bslug%5D.js" as="script"/><link rel="preload" href="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.4503cc20512dbab0b6d3.js" as="script"/><link rel="preload" href="/_next/static/chunks/a791855beec97347770a3a58274912ffcbd97990.627b6b3615d0d2a4c6c1.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-11312f39460057087083.js" as="script"/><link rel="preload" href="/_next/static/chunks/a9a7754c.29c45f57a1035e7b8fe9.js" as="script"/><link rel="preload" href="/_next/static/chunks/684459be936364224be479c65d3991c9c9cfced4.0b49a536fe8cdc6d5399.js" as="script"/></head><body><div id="__next"><header><nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white"><div class="container"><a class="navbar-brand" href="/"><img src="/assets/images/logo.png" alt="Julian Jupiter&#x27;s logo" class="icon icon-lg" style="height:45px;border:4px solid #fff;border-radius:50%"/> <!-- -->Julian Jupiter</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="#">Profile</a></li><li class="nav-item"><a class="nav-link" href="/blog">Blog</a></li><li class="nav-item"><a class="nav-link" href="/projects">Projects</a></li></ul></div></div></nav></header><main role="main"><header><nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white"><div class="container"><a class="navbar-brand" href="/"><img src="/assets/images/logo.png" alt="Julian Jupiter&#x27;s logo" class="icon icon-lg" style="height:45px;border:4px solid #fff;border-radius:50%"/> <!-- -->Julian Jupiter</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="#">Profile</a></li><li class="nav-item active"><a class="nav-link" href="/blog">Blog<!-- --> <span class="sr-only">(current)</span></a></li><li class="nav-item"><a class="nav-link" href="/projects">Projects</a></li></ul></div></div></nav></header><section class="jumbotron text-center mb-0 rouded-0"><div class="container"><h1 class="jumbotron-heading font-weight-bold text-deep-orange">Java Web Application with Embedded Tomcat</h1><p class="lead text-muted mb-0"><info dateTime="2019-08-31">August 31, 2019</info> | <a data-disqus-identifier="/blog/java-web-application-with-embedded-tomcat" href="https://julianjupiter.com/blog/java-web-application-with-embedded-tomcat#disqus_thread"></a></p></div></section><section class="bg-white" style="padding:4rem 2rem"><div class="container"><div class="row justify-content-center"><div class="col text-justify" style="font-size:1.25rem"><h3>Purpose</h3><p>This is to create a web application in Java. The Apache Tomcat will be emddeded to the JAR (not WAR), called uber/fat JAR. Other dependencies, if there is any, will also be included.</p><p>We will create a page with the following URL:</p><pre><code>http://localhost:8080/app/</code></pre><p>This page will display an introduction about embedding Tomcat with Java Web application. This also include button that is link to <em><a href="http://localhost:8080/app/books">Books</a></em> page.</p><p><strong><em>Book</em></strong> page is a list of books with columns: <strong><em>ID</em></strong>, <strong><em>Title</em></strong>, <strong><em>Edition</em></strong> and <strong><em>Action</em></strong> button that when clicked will display a modal consisting more information about selected book.</p><h3>Requirements</h3><ul><li>JDK 8</li><li>Maven</li><li>an IDE - Eclipse (Or NetBeans, Intellij IDEA, if you prefer)</li></ul><h3>Build with Maven</h3><p>First, we&#x27;ll create a Java Maven project. Open your terminal and cd to your preferred workspace and run the following commands:</p><pre><code class="language-bash">$ mkdir java-web-app-with-embedded-tomcat
$ cd java-web-app-with-embedded-tomcat
$ mkdir -p src/main/java/io/github/julinjupiter/app
$ mkdir src/main/resources
$ mkdir -p src/main/webapp/WEB-INF
$ touch pom.xml</code></pre><p><em>Note:</em> you can choose your own package instead of <em>io/github/julianjupiter/app</em> (<em>io.github.julinjupiter.app</em>)</p><p>The project structure should now be:</p><pre><code>    java-web-app-with-embedded-tomcat
    └── src
        └── main
            └── java
                └── io
                    └── github
                        └── julianjupiter
                            └── app
            └── resources
            └── webapp
                └── WEB-INF
    └── pom.xml</code></pre><p>Open <strong><em>pom.xml</em></strong> using your favorite editor (mine is <a href="https://code.visualstudio.com">Visual Studio Code</a>). Copy and paste the following XML.</p><pre><code class="language-markup">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;io.github.julianjupiter&lt;/groupId&gt;
  &lt;artifactId&gt;java-web-app-with-embedded-tomcat&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;

  &lt;name&gt;java-web-app-with-embedded-tomcat&lt;/name&gt;
  &lt;description&gt;Java Web Application with Embedded Tomcat.&lt;/description&gt;

  &lt;properties&gt;
      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
      &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
      &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
      &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
      &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;
      &lt;tomcat.version&gt;9.0.13&lt;/tomcat.version&gt;
      &lt;slf4j.version&gt;1.7.25&lt;/slf4j.version&gt;
  &lt;/properties&gt;

  &lt;dependencies&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
          &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt;
          &lt;version&gt;${tomcat.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;
          &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;
          &lt;version&gt;${tomcat.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
          &lt;artifactId&gt;jstl&lt;/artifactId&gt;
          &lt;version&gt;1.2&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;javax.json.bind&lt;/groupId&gt;
          &lt;artifactId&gt;javax.json.bind-api&lt;/artifactId&gt;
          &lt;version&gt;1.0&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.eclipse&lt;/groupId&gt;
          &lt;artifactId&gt;yasson&lt;/artifactId&gt;
          &lt;version&gt;1.0.2&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.glassfish&lt;/groupId&gt;
          &lt;artifactId&gt;javax.json&lt;/artifactId&gt;
          &lt;version&gt;1.1.3&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
          &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
          &lt;version&gt;${slf4j.version}&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
          &lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;
          &lt;version&gt;${slf4j.version}&lt;/version&gt;
      &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
      &lt;resources&gt;
          &lt;resource&gt;
              &lt;directory&gt;src/main/webapp&lt;/directory&gt;
              &lt;targetPath&gt;META-INF/resources&lt;/targetPath&gt;
          &lt;/resource&gt;
          &lt;resource&gt;
              &lt;directory&gt;src/main/resources&lt;/directory&gt;
          &lt;/resource&gt;
      &lt;/resources&gt;
      &lt;plugins&gt;
          &lt;plugin&gt;
              &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
              &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
              &lt;version&gt;3.1.1&lt;/version&gt;
              &lt;configuration&gt;
                  &lt;createDependencyReducedPom&gt;true&lt;/createDependencyReducedPom&gt;
                  &lt;filters&gt;
                      &lt;filter&gt;
                          &lt;artifact&gt;*:*&lt;/artifact&gt;
                          &lt;excludes&gt;
                              &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;
                              &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;
                              &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;
                          &lt;/excludes&gt;
                      &lt;/filter&gt;
                  &lt;/filters&gt;
              &lt;/configuration&gt;
              &lt;executions&gt;
                  &lt;execution&gt;
                      &lt;phase&gt;package&lt;/phase&gt;
                      &lt;goals&gt;
                          &lt;goal&gt;shade&lt;/goal&gt;
                      &lt;/goals&gt;
                      &lt;configuration&gt;
                          &lt;createDependencyReducedPom&gt;false&lt;/createDependencyReducedPom&gt;
                          &lt;transformers&gt;
                              &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ServicesResourceTransformer&quot;/&gt;
                              &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;
                                  &lt;mainClass&gt;io.github.julianjupiter.app.Main&lt;/mainClass&gt;
                              &lt;/transformer&gt;
                          &lt;/transformers&gt;
                      &lt;/configuration&gt;
                  &lt;/execution&gt;
              &lt;/executions&gt;
          &lt;/plugin&gt;
      &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</code></pre><p>Take note that our <strong><em>packaging</em></strong> is <strong><em>jar</em></strong> and we are using <strong><em>Maven Shade Plugin</em></strong> here to package our application into JAR. From its website, it reads:</p><p><em>This plugin provides the capability to package the artifact in an uber-jar, including its dependencies and to shade - i.e. rename - the packages of some of the dependencies.</em></p><p>Another thing worth to mention is the <strong><em>mainClass</em></strong> tag where we define our class with <strong><em>main</em></strong> method.</p><p>Lastly, we include at least two dependencies for embedding Tomcat: <em>tomcat-embed-core</em>, <em>tomcat-embed-jasper</em>.</p><h3>Import to Eclipse</h3><p>To import the project:</p><p><em>Eclipse - File &gt; Import... &gt; Maven &gt; Existing Maven Projects &gt; Browse ... (for Root Directory) &gt; Finish</em></p><h3>Let&#x27;s Start Coding</h3><h4>Server</h4><p>Create a package <strong><em>server</em></strong> under <strong><em>app</em></strong>. Under this package, we will have an interface <strong><em>Server</em></strong> and class <strong><em>TomcatServer</em></strong>. The interface will have one abstract method, <strong><em>run</em></strong> which will serve as entry point to start our Tomcat server. This opens a possibility to add more servers other than Tomcat, either from scratch or use existing ones (Jetty, Undertow).</p><h5><code>Server.java</code></h5><pre><code class="language-java">package io.github.julianjupiter.app.server;

public interface Server {
    public void run(String[] args);
}</code></pre><h5><code>TomcatServer.java</code></h5><pre><code class="language-java">package io.github.julianjupiter.app.server;

import java.io.File;

import org.apache.catalina.Context;
import org.apache.catalina.LifecycleException;
import org.apache.catalina.WebResourceRoot;
import org.apache.catalina.startup.Tomcat;
import org.apache.catalina.webresources.DirResourceSet;
import org.apache.catalina.webresources.StandardRoot;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class TomcatServer implements Server {

    private static final Logger LOGGER = LoggerFactory.getLogger(TomcatServer.class);
    private static final String DEFAULT_HOST = &quot;localhost&quot;;
    private static final int DEFAULT_PORT = 8080;
    private static final String DEFAULT_CONTEXT_PATH = &quot;/app&quot;;
    private static final String DOC_BASE = &quot;.&quot;;
    private static final String ADDITION_WEB_INF_CLASSES = &quot;target/classes&quot;;
    private static final String WEB_APP_MOUNT = &quot;/WEB-INF/classes&quot;;
    private static final String INTERNAL_PATH = &quot;/&quot;;

    @Override
    public void run(String[] args) {
        int port = port(args);
        Tomcat tomcat = tomcat(port);

        try {
            tomcat.start();
        } catch (LifecycleException exception) {
            LOGGER.error(&quot;{}&quot;, exception.getMessage());
            LOGGER.error(&quot;Exit...&quot;);
            System.exit(1);
        }

        LOGGER.info(&quot;Application started with URL {}.&quot;, DEFAULT_HOST + &quot;:&quot; + port + DEFAULT_CONTEXT_PATH);
        LOGGER.info(&quot;Hit Ctrl + D or C to stop it...&quot;);
        tomcat.getServer().await();
    }

    private int port(String[] args) {
        if (args.length &gt; 0) {
            String port = args[0];
            try {
                return Integer.valueOf(port);
            } catch (NumberFormatException exception) {
                LOGGER.error(&quot;Invalid port number argument {}&quot;, port, exception);
            }
        }

        return DEFAULT_PORT;
    }

    private Tomcat tomcat(int port) {
        Tomcat tomcat = new Tomcat();
        tomcat.setHostname(DEFAULT_HOST);
        tomcat.getHost().setAppBase(DOC_BASE);
        tomcat.setPort(port);
        tomcat.getConnector();
        context(tomcat);

        return tomcat;
    }

    private Context context(Tomcat tomcat) {
        Context context = tomcat.addWebapp(DEFAULT_CONTEXT_PATH, DOC_BASE);
        File classes = new File(ADDITION_WEB_INF_CLASSES);
        String base = classes.getAbsolutePath();
        WebResourceRoot resources = new StandardRoot(context);
        resources.addPreResources(new DirResourceSet(resources, WEB_APP_MOUNT, base, INTERNAL_PATH));
        context.setResources(resources);

        return context;
    }
}</code></pre><h5>Main.java</h5><p>We will now create our main class as defined by <strong><em>mainClass</em></strong> in pom.xml.</p><p>As this class contains <strong><em>main</em></strong> method, this will serve as entry point to start our application and the server. Here, we instantiate the <strong><em>TomcatServer</em></strong> class and call <strong><em>run</em></strong> method. We pass in <strong><em>args</em></strong> argument from <strong><em>main</em></strong> method to <strong><em>run</em></strong> method. By default, the server will listen on port <strong><em>8080</em></strong> but we can override it by passing desired port number to our <strong><em>main</em></strong> method. This is optional, though (stick to 8080).</p><pre><code class="language-java">package io.github.julianjupiter.app;

import io.github.julianjupiter.app.server.Server;
import io.github.julianjupiter.app.server.TomcatServer;

public class Main {
    public static void main(String[] args) {
        Server app = new TomcatServer();
        app.run(args);
    }
}</code></pre><p>With the codes above, we can now build and run our application, but since there is no Servlet handler or default JSP page, it will just error page.</p><p>To test our application, create a <strong><em>index.jsp</em></strong> file inside <strong><em>webapp</em></strong> folder.</p><pre><code class="language-markup">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=ISO-8859-1&quot; pageEncoding=&quot;ISO-8859-1&quot;%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;UTF-8&quot;&gt;
        &lt;title&gt;Java Web Application with Embedded Tomcat&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Hello, world!&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><p>To build and run the application, run the following commands under the root directory of the project:</p><pre><code class="language-bash">$ mvn package
$ java -jar ./target/java-web-app-with-embedded-tomcat-1.0.0-SNAPSHOT.jar</code></pre><p>If the application starts successfully, open your browser: <a href="http://localhost:8080/app">http://localhost:8080/app</a>.</p><br/>
<img class="img-fluid" src="/assets/blog/java-web-application-with-embedded-tomcat/1.PNG"/>
<br/>
<br/><h3>Add Servlet, JSPs and Other Classes</h3><h4>Domain Model</h4><h5><code>Book.java</code></h5><p>This class is simply a POJO as state container of our data.</p><pre><code class="language-java">package io.github.julianjupiter.app.domain;

import javax.json.bind.annotation.JsonbNillable;

@JsonbNillable
public class Book {
    private long id;
    private String title;
    private String edition;

    private String isbn;
    private String author;
    private String yearPublished;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getEdition() {
        return edition;
    }

    public String getIsbn() {
        return isbn;
    }

    public void setIsbn(String isbn) {
        this.isbn = isbn;
    }

    public void setEdition(String edition) {
        this.edition = edition;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }

    public String getYearPublished() {
        return yearPublished;
    }

    public void setYearPublished(String yearPublished) {
        this.yearPublished = yearPublished;
    }
}</code></pre><h4>Repository</h4><p>These serve our repository. However, the data is just a dummy for this demo.</p><h5><code>BookRepository.java</code></h5><pre><code class="language-java">    package io.github.julianjupiter.app.repository;

    import java.util.Optional;

    import io.github.julianjupiter.app.domain.Book;

    public interface BookRepository {

        Iterable&lt;Book&gt; findAll();

        Optional&lt;Book&gt; findById(long id);

    }</code></pre><h5><code>BookRepositoryImpl.java</code></h5><pre><code class="language-java">package io.github.julianjupiter.app.repository;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;

import io.github.julianjupiter.app.domain.Book;

public class BookRepositoryImpl implements BookRepository {

    private static List&lt;Book&gt; bookList = new ArrayList&lt;&gt;();

    static {
        Book book1 = new Book();
        book1.setId(1L);
        book1.setTitle(&quot;Beginning Spring Boot 2&quot;);
        book1.setIsbn(&quot;978-1-4842-2930-9&quot;);
        book1.setAuthor(&quot;K. Siva Prasad Reddy&quot;);
        book1.setYearPublished(&quot;2017&quot;);

        Book book2 = new Book();
        book2.setId(2L);
        book2.setTitle(&quot;Effective Java&quot;);
        book2.setEdition(&quot;Third Edition&quot;);
        book2.setIsbn(&quot;978-0-13-468599-1&quot;);
        book2.setAuthor(&quot;Joshua Block&quot;);
        book2.setYearPublished(&quot;2018&quot;);

        Book[] books = { book1, book2 };
        bookList = Arrays.asList(books);
    }

    @Override
    public Iterable&lt;Book&gt; findAll() {
        return bookList;
    }

    @Override
    public Optional&lt;Book&gt; findById(long id) {
        return bookList.stream()
            .filter(book -&gt; book.getId() == id)
            .findFirst();
    }

}</code></pre><h4>Service</h4><p>These serve as intermediary between our controller and repository.</p><h5><code>BookService.java</code></h5><pre><code class="language-java">package io.github.julianjupiter.app.service;

import java.util.Optional;

import io.github.julianjupiter.app.domain.Book;

public interface BookService {

    Iterable&lt;Book&gt; findAll();

    Optional&lt;Book&gt; findById(long id);

}</code></pre><h5><code>BookServiceImpl.java</code></h5><pre><code class="language-java">package io.github.julianjupiter.app.service;

import java.util.Optional;

import io.github.julianjupiter.app.domain.Book;
import io.github.julianjupiter.app.repository.BookRepository;

public class BookServiceImpl implements BookService {

    private BookRepository bookRepository;

    public BookServiceImpl(BookRepository bookRepository) {
        this.bookRepository = bookRepository;
    }

    @Override
    public Iterable&lt;Book&gt; findAll() {
        return this.bookRepository.findAll();
    }

    @Override
    public Optional&lt;Book&gt; findById(long id) {
        return this.bookRepository.findById(id);
    }

}</code></pre><h5>Controller</h5><h5><code>BaseController.java</code></h5><p>We&#x27;ll create a base controller that will contain common properties and methods to be used by our controller. We extends this class with <strong><em>HttpServlet</em></strong> so that any class (controller) that extends it becomes an Servlet too.</p><pre><code class="language-java">package io.github.julianjupiter.app.controller;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class BaseController extends HttpServlet {

    private static final long serialVersionUID = 632349127293785744L;
    private static final String VIEW_PREFIX = &quot;/WEB-INF/templates/&quot;;
    private static final String VIEW_SUFFIX = &quot;.jsp&quot;;

    protected String getAction(HttpServletRequest request) {
        String action = request.getParameter(&quot;action&quot;);

        return (action == null) || action.isEmpty() ? &quot;&quot; : action;
    }

    protected void render(HttpServletRequest request, HttpServletResponse response, String template) throws ServletException, IOException {
        getServletContext().getRequestDispatcher(VIEW_PREFIX + template + VIEW_SUFFIX).forward(request, response);
    }

    public void redirect(HttpServletResponse response, String path) throws IOException {
        response.sendRedirect(path);
    }

}</code></pre><h5><code>BookController.java</code></h5><p>The <strong><em>BookController</em></strong> extends <strong><em>BaseController</em></strong> class to become a Servlet. This will serve as the controller. Since our application will only display list of books and individual book, only <strong><em>doGet</em></strong> method will be implemented. This method intercepts all <strong><em>HTTP GET</em></strong> request.</p><pre><code class="language-java">package io.github.julianjupiter.app.controller;

import java.io.IOException;
import java.io.PrintWriter;
import java.time.ZonedDateTime;
import java.util.Optional;

import javax.json.bind.Jsonb;
import javax.json.bind.JsonbBuilder;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import io.github.julianjupiter.app.domain.Book;
import io.github.julianjupiter.app.repository.BookRepositoryImpl;
import io.github.julianjupiter.app.service.BookService;
import io.github.julianjupiter.app.service.BookServiceImpl;
import io.github.julianjupiter.app.util.Error;
import io.github.julianjupiter.app.util.ErrorResponse;

@WebServlet(name = &quot;bookController&quot;, urlPatterns = &quot;/books&quot;)
public class BookController extends BaseController {

    private static final long serialVersionUID = -8199839431714257029L;
    private static final Logger LOGGER = LoggerFactory.getLogger(BookController.class);
    private final BookService bookService;

    public BookController() {
        this.bookService = new BookServiceImpl(new BookRepositoryImpl());
    }

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String action = this.getAction(request);
        switch (action) {
            case &quot;&quot;:
            case &quot;list&quot;:
                try {
                    this.findAll(request, response);
                } catch (Exception exception) {
                    LOGGER.error(exception.getMessage());
                }

                break;
            case &quot;view&quot;:
                try {
                    this.findById(request, response);
                } catch (Exception exception) {
                    LOGGER.error(exception.getMessage());
                }

                break;

            default:
                try {
                    response.setStatus(404);
                    this.render(request, response, &quot;error/404&quot;);
                } catch (Exception exception) {
                    LOGGER.error(exception.getMessage());
                }

                break;
        }

    }

    private void findAll(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        Iterable&lt;Book&gt; books = this.bookService.findAll();
        request.setAttribute(&quot;pageName&quot;, &quot;Books&quot;);
        request.setAttribute(&quot;books&quot;, books);
        this.render(request, response, &quot;book/list&quot;);
    }

    private void findById(HttpServletRequest request, HttpServletResponse response) throws Exception {
        String id = request.getParameter(&quot;id&quot;);
        long bookId = Long.parseLong(id);
        Optional&lt;Book&gt; book = this.bookService.findById(bookId);
        String bookJson;
        try(Jsonb jsonbObject = JsonbBuilder.create()) {
            if (book.isPresent()) {
                response.setStatus(200);
                bookJson = jsonbObject.toJson(book.get());
            } else {
                response.setStatus(404);
                ErrorResponse errorResponse = new ErrorResponse();
                Error error = new Error();
                error.setMessage(&quot;Book with ID &quot; + id + &quot; was not found.&quot;);
                error.setCreatedAt(ZonedDateTime.now());
                errorResponse.setError(error);
                bookJson = jsonbObject.toJson(error);
            }
        }
        response.setContentType(&quot;application/json&quot;);
        response.setCharacterEncoding(&quot;UTF-8&quot;);
        PrintWriter out = response.getWriter();
        out.print(bookJson);
        out.flush();
    }

}</code></pre><h4>Templates</h4><p>Our templates will be written in JSP.</p><p>Let&#x27;s create first <strong><em>templates</em></strong> folder under <strong><em>/webapp/WEB-INF</em></strong>. Under this new folder, we&#x27;ll create four (4) folders - <strong><em>book</em></strong>, <strong><em>components</em></strong>, <strong><em>error</em></strong>, and <strong><em>includes</em></strong>.</p><p>The new structure of our Maven project:</p><pre><code>java-web-app-with-embedded-tomcat
└── src
    └── main
        └── java
            └── io
                └── github
                    └── julianjupiter
                        └── app
                            └── controller
                            └── domain
                            └── repository
                            └── server
                            └── service
                            └── util
        └── resources
        └── webapp
            └── WEB-INF
                └── templates
                    └── book
                    └── components
                    └── error
                    └── includes
└── pom.xml</code></pre><h5><code>includes</code></h5><p>These are the common parts of a page.</p><h6><code>init.jsp</code></h6><pre><code class="language-markup">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</code></pre><h6><code>header.jsp</code></h6><pre><code class="language-markup">&lt;%@ include file=&quot;init.jsp&quot;%&gt;
&lt;c:if test=&quot;${not empty param.pageName}&quot;&gt;
    &lt;c:set var=&quot;pageName&quot; value=&quot;${param.pageName}&quot; /&gt;
&lt;/c:if&gt;
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;
        &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;
        &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;
        &lt;link rel=&quot;icon&quot; href=&quot;${pageContext.request.contextPath}/assets/images/favicon.ico&quot;&gt;
        &lt;title&gt;${pageName} - Java Web Application with Embedded Tomcat&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;${pageContext.request.contextPath}/assets/vendor/bootstrap/4.1.3/css/bootstrap.min.css&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;${pageContext.request.contextPath}/assets/css/main.css&quot;&gt;
      &lt;/head&gt;
    &lt;body&gt;
        &lt;header&gt;
            &lt;nav class=&quot;navbar navbar-expand-lg navbar-light bg-light&quot;&gt;
                &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;Java Web Application&lt;/a&gt;
                  &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#navbarNavAltMarkup&quot; aria-controls=&quot;navbarNavAltMarkup&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
                    &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
                  &lt;/button&gt;
                  &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarNavAltMarkup&quot;&gt;
                    &lt;div class=&quot;navbar-nav&quot;&gt;
                        &lt;a class=&quot;nav-item nav-link&lt;c:if test=&quot;${pageName == &#x27;Home&#x27;}&quot;&gt; active&lt;/c:if&gt;&quot; href=&quot;${pageContext.request.contextPath}/&quot; alt=&quot;Home&quot;&gt;Home &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;
                          &lt;a class=&quot;nav-item nav-link&lt;c:if test=&quot;${pageName == &#x27;Books&#x27;}&quot;&gt; active&lt;/c:if&gt;&quot; href=&quot;${pageContext.request.contextPath}/books&quot; alt=&quot;Books&quot;&gt;Books&lt;/a&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
            &lt;/nav&gt;
        &lt;/header&gt;</code></pre><h6><code>footer.jsp</code></h6><pre><code class="language-markup">        &lt;script src=&quot;${pageContext.request.contextPath}/assets/vendor/jquery/jquery-3.3.1.slim.min.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;${pageContext.request.contextPath}/assets/vendor/popper.js/1.14.3/umd/popper.min.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;${pageContext.request.contextPath}/assets/vendor/bootstrap/4.1.3/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;${pageContext.request.contextPath}/assets/js/main.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><h5><code>error</code></h5><h4><code>404.jsp</code></h4><pre><code class="language-markup">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;UTF-8&quot;&gt;
        &lt;title&gt;Java Web Application with Embedded Tomcat&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;Error 404, Page not found!&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre><h5><code>components</code></h5><p>These are components used by our pages - modal, table.</p><h6><code>bookModal.jsp</code></h6><pre><code class="language-markup">&lt;div class=&quot;modal fade&quot; id=&quot;bookModal&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot; aria-labelledby=&quot;bookModalLabel&quot; aria-hidden=&quot;true&quot;&gt;
    &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;
        &lt;div class=&quot;modal-content&quot;&gt;
                &lt;div class=&quot;modal-header&quot;&gt;
                &lt;h5 class=&quot;modal-title&quot; id=&quot;bookModalLabel&quot;&gt;&lt;/h5&gt;
                &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;
                    &lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;
                &lt;/button&gt;
                &lt;/div&gt;
                &lt;div class=&quot;modal-body&quot;&gt;
            &lt;/div&gt;
            &lt;div class=&quot;modal-footer&quot;&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;/div&gt;
&lt;/div&gt;</code></pre><h6><code>viewBookTable.jsp</code></h6><pre><code class="language-markup">&lt;div id=&quot;viewBookTable&quot; class=&quot;table-responsive&quot; style=&quot;display:none;&quot;&gt;
    &lt;table class=&quot;table table-hover table-borderless&quot;&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;ID&lt;/th&gt;
                &lt;td id=&quot;bookId&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;Title&lt;/th&gt;
                &lt;td id=&quot;bookTitle&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;Edition&lt;/th&gt;
                &lt;td id=&quot;bookEdition&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;ISBN&lt;/th&gt;
                &lt;td id=&quot;bookIsbn&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;Author&lt;/th&gt;
                &lt;td id=&quot;bookAuthor&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;th class=&quot;text-right&quot; scope=&quot;row&quot;&gt;Year Published&lt;/th&gt;
                &lt;td id=&quot;bookYearPublished&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/div&gt;</code></pre><h5><code>book</code></h5><p>This template will be used by our page pertaining to Book in our application.</p><h6><code>list.jsp</code></h6><pre><code class="language-markup">&lt;%@ include file=&quot;/WEB-INF/templates/includes/header.jsp&quot;%&gt;
&lt;div class=&quot;jumbotron jumbotron-fluid&quot;&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;h1 class=&quot;display-4&quot;&gt;Java Web Application with Embedded Tomcat&lt;/h1&gt;
        &lt;p class=&quot;lead&quot;&gt;This is a web application in Java which runs on embedded Apache Tomcat in the form of executable JAR (not WAR), called uber/fat JAR. Other dependencies, if any, are also included.&lt;/p&gt;
      &lt;/div&gt;
&lt;/div&gt;
&lt;main&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row&quot;&gt;
            &lt;div class=&quot;col&quot;&gt;
                &lt;table class=&quot;table table-hover&quot;&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th scope=&quot;col&quot;&gt;ID&lt;/th&gt;
                              &lt;th scope=&quot;col&quot;&gt;Title&lt;/th&gt;
                              &lt;th scope=&quot;col&quot;&gt;Edition&lt;/th&gt;
                              &lt;th scope=&quot;col&quot;&gt;Action&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;
                      &lt;tbody&gt;
                          &lt;c:forEach var=&quot;book&quot; items=&quot;${books}&quot;&gt;
                        &lt;tr&gt;
                              &lt;th scope=&quot;row&quot;&gt;${book.id}&lt;/th&gt;
                              &lt;td&gt;${book.title}&lt;/td&gt;
                              &lt;td&gt;${book.edition}&lt;/td&gt;
                              &lt;td&gt;
                                  &lt;div class=&quot;btn-group&quot; role=&quot;group&quot; aria-label=&quot;Basic example&quot;&gt;
                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-info&quot; data-toggle=&quot;modal&quot; data-target=&quot;#bookModal&quot; data-book-action=&quot;viewBook&quot; data-book-id=&quot;${book.id}&quot;&gt;View&lt;/button&gt;
                                &lt;/div&gt;
                              &lt;/td&gt;
                        &lt;/tr&gt;
                        &lt;/c:forEach&gt;
                      &lt;/tbody&gt;
                &lt;/table&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/main&gt;
&lt;%@ include file=&quot;/WEB-INF/templates/components/bookModal.jsp&quot;%&gt;
&lt;%@ include file=&quot;/WEB-INF/templates/components/viewBookTable.jsp&quot;%&gt;
&lt;%@ include file=&quot;/WEB-INF/templates/includes/footer.jsp&quot;%&gt;</code></pre><h4>Default Page</h4><h5><code>index.jsp</code></h5><p>This is the default page in our application if we access <a href="http://localhost:8080/app">http://localhost:8080/app</a>.</p><p>Remember the <strong><em>index.jsp</em></strong> that we created earlier to test our application? We just need to modify that file.</p><pre><code class="language-markup">&lt;jsp:include page=&quot;/WEB-INF/templates/includes/header.jsp&quot;&gt;
    &lt;jsp:param value=&quot;Home&quot; name=&quot;pageName&quot;/&gt;
&lt;/jsp:include&gt;
        &lt;div class=&quot;jumbotron jumbotron-fluid&quot;&gt;
            &lt;div class=&quot;container&quot;&gt;
                &lt;h1 class=&quot;display-4&quot;&gt;Java Web Application with Embedded Tomcat&lt;/h1&gt;
                &lt;p class=&quot;lead&quot;&gt;This is a web application in Java which runs on embedded Apache Tomcat in the form of executable JAR (not WAR), called uber/fat JAR. Other dependencies, if any, are also included.&lt;/p&gt;
                &lt;a type=&quot;button&quot; class=&quot;btn btn-primary btn-lg&quot; href=&quot;${pageContext.request.contextPath}/books&quot; alt=&quot;Books&quot;&gt;Books&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
&lt;%@ include file=&quot;/WEB-INF/templates/includes/footer.jsp&quot;%&gt;</code></pre><h4>Static Files</h4><p>Our pages will make use of JavaScript and CSS. It includes Bootstrap CSS framework, hence, the need to import them.</p><p>Let&#x27;s create <strong><em>assets</em></strong> folder under <strong><em>/webapp</em></strong>. Under this new folder, we&#x27;ll create three (3) folders - <strong><em>css</em></strong>, <strong><em>js</em></strong>, and <strong><em>vendor</em></strong>.</p><p>Our custom styling and JavaScript files will, obviously, be put inside <strong><em>css</em></strong> and <strong><em>js</em></strong> folders, respectively, while the third-party ones, Bootstrap, jQuery, Popper.js, will be in <strong><em>vendor</em></strong> folder.</p><p>The new structure of our Maven project:</p><pre><code>java-web-app-with-embedded-tomcat
└── src
    └── main
        └── java
            └── io
                └── github
                    └── julianjupiter
                        └── app
                            └── controller
                            └── domain
                            └── repository
                            └── server
                            └── service
                            └── util
        └── resources
        └── webapp
            └── assets
                └── css
                └── js
                └── vendor
            └── WEB-INF
                └── templates
                    └── book
                    └── components
                    └── error
                    └── includes
└── pom.xml</code></pre><h6><code>css</code></h6><h6><code>main.css</code></h6><pre><code class="language-css">.table-responsive {
  display: table;
}</code></pre><h5><code>js</code></h5><h6><code>main.js</code></h6><pre><code class="language-javascript">let modalTitle = $(&quot;.modal-title&quot;);
let modalBody = $(&quot;.modal-body&quot;);
let modalFooter = $(&quot;.modal-footer&quot;);
let closeBookModal = $(
  &#x27;&lt;button id=&quot;close-book-modal&quot; type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-dismiss=&quot;modal&quot;&gt;Close&lt;/button&gt;&#x27;
);

function viewBook(bookModal, bookId) {
  let viewBookTableHidden = $(&quot;#viewBookTable:hidden&quot;);
  $(bookModal).find(modalTitle).text(&quot;View Book&quot;);
  $(bookModal).find(modalBody).html(viewBookTableHidden.clone());
  let viewBookTable = $(&quot;#viewBookTable&quot;);
  $(bookModal).find(viewBookTable).css(&quot;display&quot;, &quot;block&quot;);
  $(bookModal).find(modalFooter).append(closeBookModal);

  fetch(&quot;books?action=view&amp;id=&quot; + bookId)
    .then((response) =&gt; ({ status: response.status, data: response.json() }))
    .then((response) =&gt; {
      if (response.status == 200) {
        response.data.then((value) =&gt; {
          $(bookModal).find(&quot;#bookId&quot;).text(value.id);
          $(bookModal).find(&quot;#bookTitle&quot;).text(value.title);
          $(bookModal).find(&quot;#bookEdition&quot;).text(value.edition);
          $(bookModal).find(&quot;#bookIsbn&quot;).text(value.isbn);
          $(bookModal).find(&quot;#bookAuthor&quot;).text(value.author);
          $(bookModal).find(&quot;#bookYearPublished&quot;).text(value.yearPublished);
        });
      } else if (response.status == 404) {
        response.data.then((value) =&gt; {
          $(bookModal).find(&quot;.modal-body&quot;).html(value.message);
        });
      } else {
        $(bookModal)
          .find(&quot;.modal-body&quot;)
          .html(&quot;An unknown error occurred. Please contact Administrator.&quot;);
      }
    })
    .catch((error) =&gt; {
      console.log(&quot;Request failed&quot;, error);
      $(bookModal)
        .find(&quot;.modal-body&quot;)
        .html(&quot;An unknown error occurred. Please contact Administrator.&quot;);
    });
}

function clearModal(modal) {
  $(modal).find(modalTitle).html(&quot;&quot;);
  $(modal).find(modalBody).html(&quot;&quot;);
  $(modal).find(modalFooter).html(&quot;&quot;);
}

$(document).ready(() =&gt; {
  $(&quot;#bookModal&quot;)
    .on(&quot;show.bs.modal&quot;, function (event) {
      var bookModal = $(this);
      var button = $(event.relatedTarget);
      var bookAction = button.data(&quot;book-action&quot;);
      var bookId = button.data(&quot;book-id&quot;);

      switch (bookAction) {
        case &quot;addBook&quot;:
          addBook(bookModal);
          break;

        case &quot;viewBook&quot;:
          viewBook(this, bookId);
          break;
      }
    })
    .on(&quot;hidden.bs.modal&quot;, function (event) {
      clearModal(this);
    });
});</code></pre><h5><code>vendor</code></h5><p>For the <a title="Bootstrap · The most popular HTML, CSS, and JS library in the world." href="https://getbootstrap.com">Bootstrap</a>, <a title="jQuery" href="https://jquery.com/">jQuery</a>, and <a title="Popper - Tooltip &amp; Popover Positioning Engine" href="https://popper.js.org/">Popper.js</a>, you can download them from their respective sites.</p><p>Check <strong><em>header.jsp</em></strong> and <strong><em>footer.jsp</em></strong> files how these frameworks/libraries structured in our project.</p><h4>Re-build and Run our Application</h4><p>Run the following commands and open <a href="http://localhost/app">http://localhost:8080/app</a> in our browser.</p><pre><code class="language-bash">$ mvn clean package
$ java -jar ./target/java-web-app-with-embedded-tomcat-1.0.0-SNAPSHOT.jar</code></pre><h4>Screenshots</h4><h5>Home Page</h5><br/>
<img class="img-fluid" src="/assets/blog/java-web-application-with-embedded-tomcat/2.PNG"/>
<br/>
<br/><h5>List of Books</h5><br/>
<img class="img-fluid" src="/assets/blog/java-web-application-with-embedded-tomcat/3.PNG"/>
<br/>
<br/><h5>View a Book</h5><br/>
<img class="img-fluid" src="/assets/blog/java-web-application-with-embedded-tomcat/4.PNG"/>
<br/>
<br/><h4>Conclusion</h4><p>We&#x27;re able to create a Servlet application in which we use Embedded Tomcat Server. We build this application into a single JAR file, called Uber or Fat JAR.</p><p>With this, we no longer need a standalone web server to deploy our application to. We achieved this mechanism by using <a href="https://maven.apache.org/plugins/maven-shade-plugin/">Maven Shade Plugin</a>.</p><p>You can download complete source code <strong><a title="Java Web Application with Embedded Tomcat" href="https://github.com/julianjupiter/java-web-app-with-embedded-tomcat">here</a></strong>.</p></div></div><div class="row"><div class="col"><hr/></div></div><div class="row justify-content-center"><div class="col"><div id="disqus_thread" style="padding-top:4rem"></div><script src="/assets/js/disqus.js"></script><noscript>Please enable JavaScript to view the<!-- --> <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></div></section></main><footer class="text-white bg-deep-orange" style="padding:6rem 0"><div class="container"><div class="row mb-4 justify-content-center"><div class="col-auto"><a href="index.html"><img src="/assets/images/logo.png" alt="Julian Jupiter&#x27;s logo" class="icon icon-lg" style="height:100px;border:10px solid #fff;border-radius:50%"/></a></div></div><div class="row justify-content-center mb-2"><div class="col-auto"><ul class="nav"><li class="nav-item"><a class="nav-link text-white font-weight-bold" target="_blank" href="https://julianjupiter.com/">Home</a></li><li class="nav-item"><a class="nav-link text-white font-weight-bold" target="_blank" href="https://julianjupiter.com/priofile">Profile</a></li><li class="nav-item"><a class="nav-link text-white font-weight-bold" target="_blank" href="https://julianjupiter.com/blog">Blog</a></li><li class="nav-item"><a class="nav-link text-white font-weight-bold" target="_blank" href="https://julianjupiter.com/projects">Projects</a></li></ul></div></div><div class="row justify-content-center mb-2"><div class="col-auto"><ul class="nav"><li class="nav-item"><a class="nav-link" target="_blank" href="https://github.com/julianjupiter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github-square" class="svg-inline--fa fa-github-square fa-w-14 text-white" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="flex-shrink:0;width:auto;height:4rem"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a></li><li class="nav-item"><a class="nav-link" target="_blank" href="https://gitlab.com/julianjupiter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="gitlab" class="svg-inline--fa fa-gitlab fa-w-16 text-white" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="flex-shrink:0;width:auto;height:4rem"><path fill="currentColor" d="M105.2 24.9c-3.1-8.9-15.7-8.9-18.9 0L29.8 199.7h132c-.1 0-56.6-174.8-56.6-174.8zM.9 287.7c-2.6 8 .3 16.9 7.1 22l247.9 184-226.2-294zm160.8-88l94.3 294 94.3-294zm349.4 88l-28.8-88-226.3 294 247.9-184c6.9-5.1 9.7-14 7.2-22zM425.7 24.9c-3.1-8.9-15.7-8.9-18.9 0l-56.6 174.8h132z"></path></svg></a></li><li class="nav-item"><a class="nav-link" target="_blank" href="https://www.fcaebook.com/julianjupiter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-square" class="svg-inline--fa fa-facebook-square fa-w-14 text-white" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="flex-shrink:0;width:auto;height:4rem"><path fill="currentColor" d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"></path></svg></a></li><li class="nav-item"><a class="nav-link" target="_blank" href="https://twitter.com/julianvjupiter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter-square" class="svg-inline--fa fa-twitter-square fa-w-14 text-white" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="flex-shrink:0;width:auto;height:4rem"><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5 0 86.7-66 186.6-186.6 186.6-37.2 0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7 0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447 0 0 1-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9 0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"></path></svg></a></li></ul></div></div><div class="row justify-content-center"><div class="col col-md-auto text-center"><small class="text-white">Copyright ©<!-- --> <span id="currentYear">2020</span> <a class="text-white" href="https://julianjupiter.com/">Julian Jupiter</a><p>All Rights Reserved</p></small></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Java Web Application with Embedded Tomcat","excerpt":"This tutorial is to create a Java web application using embedded Apache Tomcat web server.","date":"2019-08-31","image":{"cover":"/assets/blog/java-web-application-with-embedded-tomcat/cover.PNG","og":"/assets/blog/java-web-application-with-embedded-tomcat/cover.PNG"},"slug":"java-web-application-with-embedded-tomcat","content":"\r\n### Purpose\r\n\r\nThis is to create a web application in Java. The Apache Tomcat will be emddeded to the JAR (not WAR), called uber/fat JAR. Other dependencies, if there is any, will also be included.\r\n\r\nWe will create a page with the following URL:\r\n\r\n```\r\nhttp://localhost:8080/app/\r\n```\r\n\r\nThis page will display an introduction about embedding Tomcat with Java Web application. This also include button that is link to _[Books](http://localhost:8080/app/books)_ page.\r\n\r\n**_Book_** page is a list of books with columns: **_ID_**, **_Title_**, **_Edition_** and **_Action_** button that when clicked will display a modal consisting more information about selected book.\r\n\r\n### Requirements\r\n\r\n- JDK 8\r\n- Maven\r\n- an IDE - Eclipse (Or NetBeans, Intellij IDEA, if you prefer)\r\n\r\n### Build with Maven\r\n\r\nFirst, we'll create a Java Maven project. Open your terminal and cd to your preferred workspace and run the following commands:\r\n\r\n```bash\r\n$ mkdir java-web-app-with-embedded-tomcat\r\n$ cd java-web-app-with-embedded-tomcat\r\n$ mkdir -p src/main/java/io/github/julinjupiter/app\r\n$ mkdir src/main/resources\r\n$ mkdir -p src/main/webapp/WEB-INF\r\n$ touch pom.xml\r\n```\r\n\r\n_Note:_ you can choose your own package instead of _io/github/julianjupiter/app_ (_io.github.julinjupiter.app_)\r\n\r\nThe project structure should now be:\r\n\r\n```\r\n    java-web-app-with-embedded-tomcat\r\n    └── src\r\n        └── main\r\n            └── java\r\n                └── io\r\n                    └── github\r\n                        └── julianjupiter\r\n                            └── app\r\n            └── resources\r\n            └── webapp\r\n                └── WEB-INF\r\n    └── pom.xml\r\n```\r\n\r\nOpen **_pom.xml_** using your favorite editor (mine is [Visual Studio Code](https://code.visualstudio.com)). Copy and paste the following XML.\r\n\r\n```markup\r\n\u003cproject xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\u003e\r\n  \u003cmodelVersion\u003e4.0.0\u003c/modelVersion\u003e\r\n  \u003cgroupId\u003eio.github.julianjupiter\u003c/groupId\u003e\r\n  \u003cartifactId\u003ejava-web-app-with-embedded-tomcat\u003c/artifactId\u003e\r\n  \u003cversion\u003e1.0.0-SNAPSHOT\u003c/version\u003e\r\n  \u003cpackaging\u003ejar\u003c/packaging\u003e\r\n\r\n  \u003cname\u003ejava-web-app-with-embedded-tomcat\u003c/name\u003e\r\n  \u003cdescription\u003eJava Web Application with Embedded Tomcat.\u003c/description\u003e\r\n\r\n  \u003cproperties\u003e\r\n      \u003cproject.build.sourceEncoding\u003eUTF-8\u003c/project.build.sourceEncoding\u003e\r\n      \u003cproject.reporting.outputEncoding\u003eUTF-8\u003c/project.reporting.outputEncoding\u003e\r\n      \u003cmaven.compiler.source\u003e1.8\u003c/maven.compiler.source\u003e\r\n      \u003cmaven.compiler.target\u003e1.8\u003c/maven.compiler.target\u003e\r\n      \u003cfailOnMissingWebXml\u003efalse\u003c/failOnMissingWebXml\u003e\r\n      \u003ctomcat.version\u003e9.0.13\u003c/tomcat.version\u003e\r\n      \u003cslf4j.version\u003e1.7.25\u003c/slf4j.version\u003e\r\n  \u003c/properties\u003e\r\n\r\n  \u003cdependencies\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.apache.tomcat.embed\u003c/groupId\u003e\r\n          \u003cartifactId\u003etomcat-embed-core\u003c/artifactId\u003e\r\n          \u003cversion\u003e${tomcat.version}\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.apache.tomcat.embed\u003c/groupId\u003e\r\n          \u003cartifactId\u003etomcat-embed-jasper\u003c/artifactId\u003e\r\n          \u003cversion\u003e${tomcat.version}\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003ejavax.servlet\u003c/groupId\u003e\r\n          \u003cartifactId\u003ejstl\u003c/artifactId\u003e\r\n          \u003cversion\u003e1.2\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003ejavax.json.bind\u003c/groupId\u003e\r\n          \u003cartifactId\u003ejavax.json.bind-api\u003c/artifactId\u003e\r\n          \u003cversion\u003e1.0\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.eclipse\u003c/groupId\u003e\r\n          \u003cartifactId\u003eyasson\u003c/artifactId\u003e\r\n          \u003cversion\u003e1.0.2\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.glassfish\u003c/groupId\u003e\r\n          \u003cartifactId\u003ejavax.json\u003c/artifactId\u003e\r\n          \u003cversion\u003e1.1.3\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.slf4j\u003c/groupId\u003e\r\n          \u003cartifactId\u003eslf4j-log4j12\u003c/artifactId\u003e\r\n          \u003cversion\u003e${slf4j.version}\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n      \u003cdependency\u003e\r\n          \u003cgroupId\u003eorg.slf4j\u003c/groupId\u003e\r\n          \u003cartifactId\u003ejcl-over-slf4j\u003c/artifactId\u003e\r\n          \u003cversion\u003e${slf4j.version}\u003c/version\u003e\r\n      \u003c/dependency\u003e\r\n  \u003c/dependencies\u003e\r\n\r\n  \u003cbuild\u003e\r\n      \u003cresources\u003e\r\n          \u003cresource\u003e\r\n              \u003cdirectory\u003esrc/main/webapp\u003c/directory\u003e\r\n              \u003ctargetPath\u003eMETA-INF/resources\u003c/targetPath\u003e\r\n          \u003c/resource\u003e\r\n          \u003cresource\u003e\r\n              \u003cdirectory\u003esrc/main/resources\u003c/directory\u003e\r\n          \u003c/resource\u003e\r\n      \u003c/resources\u003e\r\n      \u003cplugins\u003e\r\n          \u003cplugin\u003e\r\n              \u003cgroupId\u003eorg.apache.maven.plugins\u003c/groupId\u003e\r\n              \u003cartifactId\u003emaven-shade-plugin\u003c/artifactId\u003e\r\n              \u003cversion\u003e3.1.1\u003c/version\u003e\r\n              \u003cconfiguration\u003e\r\n                  \u003ccreateDependencyReducedPom\u003etrue\u003c/createDependencyReducedPom\u003e\r\n                  \u003cfilters\u003e\r\n                      \u003cfilter\u003e\r\n                          \u003cartifact\u003e*:*\u003c/artifact\u003e\r\n                          \u003cexcludes\u003e\r\n                              \u003cexclude\u003eMETA-INF/*.SF\u003c/exclude\u003e\r\n                              \u003cexclude\u003eMETA-INF/*.DSA\u003c/exclude\u003e\r\n                              \u003cexclude\u003eMETA-INF/*.RSA\u003c/exclude\u003e\r\n                          \u003c/excludes\u003e\r\n                      \u003c/filter\u003e\r\n                  \u003c/filters\u003e\r\n              \u003c/configuration\u003e\r\n              \u003cexecutions\u003e\r\n                  \u003cexecution\u003e\r\n                      \u003cphase\u003epackage\u003c/phase\u003e\r\n                      \u003cgoals\u003e\r\n                          \u003cgoal\u003eshade\u003c/goal\u003e\r\n                      \u003c/goals\u003e\r\n                      \u003cconfiguration\u003e\r\n                          \u003ccreateDependencyReducedPom\u003efalse\u003c/createDependencyReducedPom\u003e\r\n                          \u003ctransformers\u003e\r\n                              \u003ctransformer implementation=\"org.apache.maven.plugins.shade.resource.ServicesResourceTransformer\"/\u003e\r\n                              \u003ctransformer implementation=\"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer\"\u003e\r\n                                  \u003cmainClass\u003eio.github.julianjupiter.app.Main\u003c/mainClass\u003e\r\n                              \u003c/transformer\u003e\r\n                          \u003c/transformers\u003e\r\n                      \u003c/configuration\u003e\r\n                  \u003c/execution\u003e\r\n              \u003c/executions\u003e\r\n          \u003c/plugin\u003e\r\n      \u003c/plugins\u003e\r\n  \u003c/build\u003e\r\n\u003c/project\u003e\r\n```\r\n\r\nTake note that our **_packaging_** is **_jar_** and we are using **_Maven Shade Plugin_** here to package our application into JAR. From its website, it reads:\r\n\r\n_This plugin provides the capability to package the artifact in an uber-jar, including its dependencies and to shade - i.e. rename - the packages of some of the dependencies._\r\n\r\nAnother thing worth to mention is the **_mainClass_** tag where we define our class with **_main_** method.\r\n\r\nLastly, we include at least two dependencies for embedding Tomcat: _tomcat-embed-core_, _tomcat-embed-jasper_.\r\n\r\n### Import to Eclipse\r\n\r\nTo import the project:\r\n\r\n_Eclipse - File \u003e Import... \u003e Maven \u003e Existing Maven Projects \u003e Browse ... (for Root Directory) \u003e Finish_\r\n\r\n### Let's Start Coding\r\n\r\n#### Server\r\n\r\nCreate a package **_server_** under **_app_**. Under this package, we will have an interface **_Server_** and class **_TomcatServer_**. The interface will have one abstract method, **_run_** which will serve as entry point to start our Tomcat server. This opens a possibility to add more servers other than Tomcat, either from scratch or use existing ones (Jetty, Undertow).\r\n\r\n##### `Server.java`\r\n\r\n```java\r\npackage io.github.julianjupiter.app.server;\r\n\r\npublic interface Server {\r\n    public void run(String[] args);\r\n}\r\n```\r\n\r\n##### `TomcatServer.java`\r\n\r\n```java\r\npackage io.github.julianjupiter.app.server;\r\n\r\nimport java.io.File;\r\n\r\nimport org.apache.catalina.Context;\r\nimport org.apache.catalina.LifecycleException;\r\nimport org.apache.catalina.WebResourceRoot;\r\nimport org.apache.catalina.startup.Tomcat;\r\nimport org.apache.catalina.webresources.DirResourceSet;\r\nimport org.apache.catalina.webresources.StandardRoot;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\n\r\npublic class TomcatServer implements Server {\r\n\r\n    private static final Logger LOGGER = LoggerFactory.getLogger(TomcatServer.class);\r\n    private static final String DEFAULT_HOST = \"localhost\";\r\n    private static final int DEFAULT_PORT = 8080;\r\n    private static final String DEFAULT_CONTEXT_PATH = \"/app\";\r\n    private static final String DOC_BASE = \".\";\r\n    private static final String ADDITION_WEB_INF_CLASSES = \"target/classes\";\r\n    private static final String WEB_APP_MOUNT = \"/WEB-INF/classes\";\r\n    private static final String INTERNAL_PATH = \"/\";\r\n\r\n    @Override\r\n    public void run(String[] args) {\r\n        int port = port(args);\r\n        Tomcat tomcat = tomcat(port);\r\n\r\n        try {\r\n            tomcat.start();\r\n        } catch (LifecycleException exception) {\r\n            LOGGER.error(\"{}\", exception.getMessage());\r\n            LOGGER.error(\"Exit...\");\r\n            System.exit(1);\r\n        }\r\n\r\n        LOGGER.info(\"Application started with URL {}.\", DEFAULT_HOST + \":\" + port + DEFAULT_CONTEXT_PATH);\r\n        LOGGER.info(\"Hit Ctrl + D or C to stop it...\");\r\n        tomcat.getServer().await();\r\n    }\r\n\r\n    private int port(String[] args) {\r\n        if (args.length \u003e 0) {\r\n            String port = args[0];\r\n            try {\r\n                return Integer.valueOf(port);\r\n            } catch (NumberFormatException exception) {\r\n                LOGGER.error(\"Invalid port number argument {}\", port, exception);\r\n            }\r\n        }\r\n\r\n        return DEFAULT_PORT;\r\n    }\r\n\r\n    private Tomcat tomcat(int port) {\r\n        Tomcat tomcat = new Tomcat();\r\n        tomcat.setHostname(DEFAULT_HOST);\r\n        tomcat.getHost().setAppBase(DOC_BASE);\r\n        tomcat.setPort(port);\r\n        tomcat.getConnector();\r\n        context(tomcat);\r\n\r\n        return tomcat;\r\n    }\r\n\r\n    private Context context(Tomcat tomcat) {\r\n        Context context = tomcat.addWebapp(DEFAULT_CONTEXT_PATH, DOC_BASE);\r\n        File classes = new File(ADDITION_WEB_INF_CLASSES);\r\n        String base = classes.getAbsolutePath();\r\n        WebResourceRoot resources = new StandardRoot(context);\r\n        resources.addPreResources(new DirResourceSet(resources, WEB_APP_MOUNT, base, INTERNAL_PATH));\r\n        context.setResources(resources);\r\n\r\n        return context;\r\n    }\r\n}\r\n```\r\n\r\n##### Main.java\r\n\r\nWe will now create our main class as defined by **_mainClass_** in pom.xml.\r\n\r\nAs this class contains **_main_** method, this will serve as entry point to start our application and the server. Here, we instantiate the **_TomcatServer_** class and call **_run_** method. We pass in **_args_** argument from **_main_** method to **_run_** method. By default, the server will listen on port **_8080_** but we can override it by passing desired port number to our **_main_** method. This is optional, though (stick to 8080).\r\n\r\n```java\r\npackage io.github.julianjupiter.app;\r\n\r\nimport io.github.julianjupiter.app.server.Server;\r\nimport io.github.julianjupiter.app.server.TomcatServer;\r\n\r\npublic class Main {\r\n    public static void main(String[] args) {\r\n        Server app = new TomcatServer();\r\n        app.run(args);\r\n    }\r\n}\r\n```\r\n\r\nWith the codes above, we can now build and run our application, but since there is no Servlet handler or default JSP page, it will just error page.\r\n\r\nTo test our application, create a **_index.jsp_** file inside **_webapp_** folder.\r\n\r\n```markup\r\n\u003c%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%\u003e\r\n\u003c!DOCTYPE html\u003e\r\n\u003chtml\u003e\r\n    \u003chead\u003e\r\n        \u003cmeta charset=\"UTF-8\"\u003e\r\n        \u003ctitle\u003eJava Web Application with Embedded Tomcat\u003c/title\u003e\r\n    \u003c/head\u003e\r\n    \u003cbody\u003e\r\n        \u003ch1\u003eHello, world!\u003c/h1\u003e\r\n    \u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\nTo build and run the application, run the following commands under the root directory of the project:\r\n\r\n```bash\r\n$ mvn package\r\n$ java -jar ./target/java-web-app-with-embedded-tomcat-1.0.0-SNAPSHOT.jar\r\n```\r\n\r\nIf the application starts successfully, open your browser: [http://localhost:8080/app](http://localhost:8080/app).\r\n\r\n\u003cbr\u003e\r\n\u003cimg class=\"img-fluid\" src=\"/assets/blog/java-web-application-with-embedded-tomcat/1.PNG\"\u003e\r\n\u003cbr\u003e\r\n\u003cbr\u003e\r\n\r\n### Add Servlet, JSPs and Other Classes\r\n\r\n#### Domain Model\r\n\r\n##### `Book.java`\r\n\r\nThis class is simply a POJO as state container of our data.\r\n\r\n```java\r\npackage io.github.julianjupiter.app.domain;\r\n\r\nimport javax.json.bind.annotation.JsonbNillable;\r\n\r\n@JsonbNillable\r\npublic class Book {\r\n    private long id;\r\n    private String title;\r\n    private String edition;\r\n\r\n    private String isbn;\r\n    private String author;\r\n    private String yearPublished;\r\n\r\n    public long getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(long id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getTitle() {\r\n        return title;\r\n    }\r\n\r\n    public void setTitle(String title) {\r\n        this.title = title;\r\n    }\r\n\r\n    public String getEdition() {\r\n        return edition;\r\n    }\r\n\r\n    public String getIsbn() {\r\n        return isbn;\r\n    }\r\n\r\n    public void setIsbn(String isbn) {\r\n        this.isbn = isbn;\r\n    }\r\n\r\n    public void setEdition(String edition) {\r\n        this.edition = edition;\r\n    }\r\n\r\n    public String getAuthor() {\r\n        return author;\r\n    }\r\n\r\n    public void setAuthor(String author) {\r\n        this.author = author;\r\n    }\r\n\r\n    public String getYearPublished() {\r\n        return yearPublished;\r\n    }\r\n\r\n    public void setYearPublished(String yearPublished) {\r\n        this.yearPublished = yearPublished;\r\n    }\r\n}\r\n```\r\n\r\n#### Repository\r\n\r\nThese serve our repository. However, the data is just a dummy for this demo.\r\n\r\n##### `BookRepository.java`\r\n\r\n```java\r\n    package io.github.julianjupiter.app.repository;\r\n\r\n    import java.util.Optional;\r\n\r\n    import io.github.julianjupiter.app.domain.Book;\r\n\r\n    public interface BookRepository {\r\n\r\n        Iterable\u003cBook\u003e findAll();\r\n\r\n        Optional\u003cBook\u003e findById(long id);\r\n\r\n    }\r\n```\r\n\r\n##### `BookRepositoryImpl.java`\r\n\r\n```java\r\npackage io.github.julianjupiter.app.repository;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Optional;\r\n\r\nimport io.github.julianjupiter.app.domain.Book;\r\n\r\npublic class BookRepositoryImpl implements BookRepository {\r\n\r\n    private static List\u003cBook\u003e bookList = new ArrayList\u003c\u003e();\r\n\r\n    static {\r\n        Book book1 = new Book();\r\n        book1.setId(1L);\r\n        book1.setTitle(\"Beginning Spring Boot 2\");\r\n        book1.setIsbn(\"978-1-4842-2930-9\");\r\n        book1.setAuthor(\"K. Siva Prasad Reddy\");\r\n        book1.setYearPublished(\"2017\");\r\n\r\n        Book book2 = new Book();\r\n        book2.setId(2L);\r\n        book2.setTitle(\"Effective Java\");\r\n        book2.setEdition(\"Third Edition\");\r\n        book2.setIsbn(\"978-0-13-468599-1\");\r\n        book2.setAuthor(\"Joshua Block\");\r\n        book2.setYearPublished(\"2018\");\r\n\r\n        Book[] books = { book1, book2 };\r\n        bookList = Arrays.asList(books);\r\n    }\r\n\r\n    @Override\r\n    public Iterable\u003cBook\u003e findAll() {\r\n        return bookList;\r\n    }\r\n\r\n    @Override\r\n    public Optional\u003cBook\u003e findById(long id) {\r\n        return bookList.stream()\r\n            .filter(book -\u003e book.getId() == id)\r\n            .findFirst();\r\n    }\r\n\r\n}\r\n```\r\n\r\n#### Service\r\n\r\nThese serve as intermediary between our controller and repository.\r\n\r\n##### `BookService.java`\r\n\r\n```java\r\npackage io.github.julianjupiter.app.service;\r\n\r\nimport java.util.Optional;\r\n\r\nimport io.github.julianjupiter.app.domain.Book;\r\n\r\npublic interface BookService {\r\n\r\n    Iterable\u003cBook\u003e findAll();\r\n\r\n    Optional\u003cBook\u003e findById(long id);\r\n\r\n}\r\n```\r\n\r\n##### `BookServiceImpl.java`\r\n\r\n```java\r\npackage io.github.julianjupiter.app.service;\r\n\r\nimport java.util.Optional;\r\n\r\nimport io.github.julianjupiter.app.domain.Book;\r\nimport io.github.julianjupiter.app.repository.BookRepository;\r\n\r\npublic class BookServiceImpl implements BookService {\r\n\r\n    private BookRepository bookRepository;\r\n\r\n    public BookServiceImpl(BookRepository bookRepository) {\r\n        this.bookRepository = bookRepository;\r\n    }\r\n\r\n    @Override\r\n    public Iterable\u003cBook\u003e findAll() {\r\n        return this.bookRepository.findAll();\r\n    }\r\n\r\n    @Override\r\n    public Optional\u003cBook\u003e findById(long id) {\r\n        return this.bookRepository.findById(id);\r\n    }\r\n\r\n}\r\n```\r\n\r\n##### Controller\r\n\r\n##### `BaseController.java`\r\n\r\nWe'll create a base controller that will contain common properties and methods to be used by our controller. We extends this class with **_HttpServlet_** so that any class (controller) that extends it becomes an Servlet too.\r\n\r\n```java\r\npackage io.github.julianjupiter.app.controller;\r\n\r\nimport java.io.IOException;\r\n\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.http.HttpServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\n\r\npublic class BaseController extends HttpServlet {\r\n\r\n    private static final long serialVersionUID = 632349127293785744L;\r\n    private static final String VIEW_PREFIX = \"/WEB-INF/templates/\";\r\n    private static final String VIEW_SUFFIX = \".jsp\";\r\n\r\n    protected String getAction(HttpServletRequest request) {\r\n        String action = request.getParameter(\"action\");\r\n\r\n        return (action == null) || action.isEmpty() ? \"\" : action;\r\n    }\r\n\r\n    protected void render(HttpServletRequest request, HttpServletResponse response, String template) throws ServletException, IOException {\r\n        getServletContext().getRequestDispatcher(VIEW_PREFIX + template + VIEW_SUFFIX).forward(request, response);\r\n    }\r\n\r\n    public void redirect(HttpServletResponse response, String path) throws IOException {\r\n        response.sendRedirect(path);\r\n    }\r\n\r\n}\r\n```\r\n\r\n##### `BookController.java`\r\n\r\nThe **_BookController_** extends **_BaseController_** class to become a Servlet. This will serve as the controller. Since our application will only display list of books and individual book, only **_doGet_** method will be implemented. This method intercepts all **_HTTP GET_** request.\r\n\r\n```java\r\npackage io.github.julianjupiter.app.controller;\r\n\r\nimport java.io.IOException;\r\nimport java.io.PrintWriter;\r\nimport java.time.ZonedDateTime;\r\nimport java.util.Optional;\r\n\r\nimport javax.json.bind.Jsonb;\r\nimport javax.json.bind.JsonbBuilder;\r\nimport javax.servlet.ServletException;\r\nimport javax.servlet.annotation.WebServlet;\r\nimport javax.servlet.http.HttpServletRequest;\r\nimport javax.servlet.http.HttpServletResponse;\r\n\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\n\r\nimport io.github.julianjupiter.app.domain.Book;\r\nimport io.github.julianjupiter.app.repository.BookRepositoryImpl;\r\nimport io.github.julianjupiter.app.service.BookService;\r\nimport io.github.julianjupiter.app.service.BookServiceImpl;\r\nimport io.github.julianjupiter.app.util.Error;\r\nimport io.github.julianjupiter.app.util.ErrorResponse;\r\n\r\n@WebServlet(name = \"bookController\", urlPatterns = \"/books\")\r\npublic class BookController extends BaseController {\r\n\r\n    private static final long serialVersionUID = -8199839431714257029L;\r\n    private static final Logger LOGGER = LoggerFactory.getLogger(BookController.class);\r\n    private final BookService bookService;\r\n\r\n    public BookController() {\r\n        this.bookService = new BookServiceImpl(new BookRepositoryImpl());\r\n    }\r\n\r\n    @Override\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        String action = this.getAction(request);\r\n        switch (action) {\r\n            case \"\":\r\n            case \"list\":\r\n                try {\r\n                    this.findAll(request, response);\r\n                } catch (Exception exception) {\r\n                    LOGGER.error(exception.getMessage());\r\n                }\r\n\r\n                break;\r\n            case \"view\":\r\n                try {\r\n                    this.findById(request, response);\r\n                } catch (Exception exception) {\r\n                    LOGGER.error(exception.getMessage());\r\n                }\r\n\r\n                break;\r\n\r\n            default:\r\n                try {\r\n                    response.setStatus(404);\r\n                    this.render(request, response, \"error/404\");\r\n                } catch (Exception exception) {\r\n                    LOGGER.error(exception.getMessage());\r\n                }\r\n\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    private void findAll(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\r\n        Iterable\u003cBook\u003e books = this.bookService.findAll();\r\n        request.setAttribute(\"pageName\", \"Books\");\r\n        request.setAttribute(\"books\", books);\r\n        this.render(request, response, \"book/list\");\r\n    }\r\n\r\n    private void findById(HttpServletRequest request, HttpServletResponse response) throws Exception {\r\n        String id = request.getParameter(\"id\");\r\n        long bookId = Long.parseLong(id);\r\n        Optional\u003cBook\u003e book = this.bookService.findById(bookId);\r\n        String bookJson;\r\n        try(Jsonb jsonbObject = JsonbBuilder.create()) {\r\n            if (book.isPresent()) {\r\n                response.setStatus(200);\r\n                bookJson = jsonbObject.toJson(book.get());\r\n            } else {\r\n                response.setStatus(404);\r\n                ErrorResponse errorResponse = new ErrorResponse();\r\n                Error error = new Error();\r\n                error.setMessage(\"Book with ID \" + id + \" was not found.\");\r\n                error.setCreatedAt(ZonedDateTime.now());\r\n                errorResponse.setError(error);\r\n                bookJson = jsonbObject.toJson(error);\r\n            }\r\n        }\r\n        response.setContentType(\"application/json\");\r\n        response.setCharacterEncoding(\"UTF-8\");\r\n        PrintWriter out = response.getWriter();\r\n        out.print(bookJson);\r\n        out.flush();\r\n    }\r\n\r\n}\r\n```\r\n\r\n#### Templates\r\n\r\nOur templates will be written in JSP.\r\n\r\nLet's create first **_templates_** folder under **_/webapp/WEB-INF_**. Under this new folder, we'll create four (4) folders - **_book_**, **_components_**, **_error_**, and **_includes_**.\r\n\r\nThe new structure of our Maven project:\r\n\r\n```\r\njava-web-app-with-embedded-tomcat\r\n└── src\r\n    └── main\r\n        └── java\r\n            └── io\r\n                └── github\r\n                    └── julianjupiter\r\n                        └── app\r\n                            └── controller\r\n                            └── domain\r\n                            └── repository\r\n                            └── server\r\n                            └── service\r\n                            └── util\r\n        └── resources\r\n        └── webapp\r\n            └── WEB-INF\r\n                └── templates\r\n                    └── book\r\n                    └── components\r\n                    └── error\r\n                    └── includes\r\n└── pom.xml\r\n```\r\n\r\n##### `includes`\r\n\r\nThese are the common parts of a page.\r\n\r\n###### `init.jsp`\r\n\r\n```markup\r\n\u003c%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%\u003e\r\n\u003c%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\"%\u003e\r\n```\r\n\r\n###### `header.jsp`\r\n\r\n```markup\r\n\u003c%@ include file=\"init.jsp\"%\u003e\r\n\u003cc:if test=\"${not empty param.pageName}\"\u003e\r\n    \u003cc:set var=\"pageName\" value=\"${param.pageName}\" /\u003e\r\n\u003c/c:if\u003e\r\n\u003c!doctype html\u003e\r\n\u003chtml lang=\"en\"\u003e\r\n    \u003chead\u003e\r\n        \u003cmeta charset=\"utf-8\"\u003e\r\n        \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\u003e\r\n        \u003cmeta name=\"description\" content=\"\"\u003e\r\n        \u003cmeta name=\"author\" content=\"\"\u003e\r\n        \u003clink rel=\"icon\" href=\"${pageContext.request.contextPath}/assets/images/favicon.ico\"\u003e\r\n        \u003ctitle\u003e${pageName} - Java Web Application with Embedded Tomcat\u003c/title\u003e\r\n        \u003clink rel=\"stylesheet\" href=\"${pageContext.request.contextPath}/assets/vendor/bootstrap/4.1.3/css/bootstrap.min.css\"\u003e\r\n        \u003clink rel=\"stylesheet\" href=\"${pageContext.request.contextPath}/assets/css/main.css\"\u003e\r\n      \u003c/head\u003e\r\n    \u003cbody\u003e\r\n        \u003cheader\u003e\r\n            \u003cnav class=\"navbar navbar-expand-lg navbar-light bg-light\"\u003e\r\n                \u003ca class=\"navbar-brand\" href=\"#\"\u003eJava Web Application\u003c/a\u003e\r\n                  \u003cbutton class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarNavAltMarkup\" aria-controls=\"navbarNavAltMarkup\" aria-expanded=\"false\" aria-label=\"Toggle navigation\"\u003e\r\n                    \u003cspan class=\"navbar-toggler-icon\"\u003e\u003c/span\u003e\r\n                  \u003c/button\u003e\r\n                  \u003cdiv class=\"collapse navbar-collapse\" id=\"navbarNavAltMarkup\"\u003e\r\n                    \u003cdiv class=\"navbar-nav\"\u003e\r\n                        \u003ca class=\"nav-item nav-link\u003cc:if test=\"${pageName == 'Home'}\"\u003e active\u003c/c:if\u003e\" href=\"${pageContext.request.contextPath}/\" alt=\"Home\"\u003eHome \u003cspan class=\"sr-only\"\u003e(current)\u003c/span\u003e\u003c/a\u003e\r\n                          \u003ca class=\"nav-item nav-link\u003cc:if test=\"${pageName == 'Books'}\"\u003e active\u003c/c:if\u003e\" href=\"${pageContext.request.contextPath}/books\" alt=\"Books\"\u003eBooks\u003c/a\u003e\r\n                    \u003c/div\u003e\r\n                  \u003c/div\u003e\r\n            \u003c/nav\u003e\r\n        \u003c/header\u003e\r\n```\r\n\r\n###### `footer.jsp`\r\n\r\n```markup\r\n        \u003cscript src=\"${pageContext.request.contextPath}/assets/vendor/jquery/jquery-3.3.1.slim.min.js\"\u003e\u003c/script\u003e\r\n        \u003cscript src=\"${pageContext.request.contextPath}/assets/vendor/popper.js/1.14.3/umd/popper.min.js\"\u003e\u003c/script\u003e\r\n        \u003cscript src=\"${pageContext.request.contextPath}/assets/vendor/bootstrap/4.1.3/js/bootstrap.min.js\"\u003e\u003c/script\u003e\r\n        \u003cscript src=\"${pageContext.request.contextPath}/assets/js/main.js\"\u003e\u003c/script\u003e\r\n    \u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\n##### `error`\r\n\r\n#### `404.jsp`\r\n\r\n```markup\r\n\u003c%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%\u003e\r\n\u003c!DOCTYPE html\u003e\r\n\u003chtml\u003e\r\n    \u003chead\u003e\r\n        \u003cmeta charset=\"UTF-8\"\u003e\r\n        \u003ctitle\u003eJava Web Application with Embedded Tomcat\u003c/title\u003e\r\n    \u003c/head\u003e\r\n    \u003cbody\u003e\r\n        \u003ch1\u003eError 404, Page not found!\u003c/h1\u003e\r\n    \u003c/body\u003e\r\n\u003c/html\u003e\r\n```\r\n\r\n##### `components`\r\n\r\nThese are components used by our pages - modal, table.\r\n\r\n###### `bookModal.jsp`\r\n\r\n```markup\r\n\u003cdiv class=\"modal fade\" id=\"bookModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"bookModalLabel\" aria-hidden=\"true\"\u003e\r\n    \u003cdiv class=\"modal-dialog\" role=\"document\"\u003e\r\n        \u003cdiv class=\"modal-content\"\u003e\r\n                \u003cdiv class=\"modal-header\"\u003e\r\n                \u003ch5 class=\"modal-title\" id=\"bookModalLabel\"\u003e\u003c/h5\u003e\r\n                \u003cbutton type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"\u003e\r\n                    \u003cspan aria-hidden=\"true\"\u003e\u0026times;\u003c/span\u003e\r\n                \u003c/button\u003e\r\n                \u003c/div\u003e\r\n                \u003cdiv class=\"modal-body\"\u003e\r\n            \u003c/div\u003e\r\n            \u003cdiv class=\"modal-footer\"\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n        \u003c/div\u003e\r\n\u003c/div\u003e\r\n```\r\n\r\n###### `viewBookTable.jsp`\r\n\r\n```markup\r\n\u003cdiv id=\"viewBookTable\" class=\"table-responsive\" style=\"display:none;\"\u003e\r\n    \u003ctable class=\"table table-hover table-borderless\"\u003e\r\n        \u003ctbody\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eID\u003c/th\u003e\r\n                \u003ctd id=\"bookId\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eTitle\u003c/th\u003e\r\n                \u003ctd id=\"bookTitle\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eEdition\u003c/th\u003e\r\n                \u003ctd id=\"bookEdition\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eISBN\u003c/th\u003e\r\n                \u003ctd id=\"bookIsbn\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eAuthor\u003c/th\u003e\r\n                \u003ctd id=\"bookAuthor\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n            \u003ctr\u003e\r\n                \u003cth class=\"text-right\" scope=\"row\"\u003eYear Published\u003c/th\u003e\r\n                \u003ctd id=\"bookYearPublished\"\u003e\u003c/td\u003e\r\n            \u003c/tr\u003e\r\n        \u003c/tbody\u003e\r\n    \u003c/table\u003e\r\n\u003c/div\u003e\r\n```\r\n\r\n##### `book`\r\n\r\nThis template will be used by our page pertaining to Book in our application.\r\n\r\n###### `list.jsp`\r\n\r\n```markup\r\n\u003c%@ include file=\"/WEB-INF/templates/includes/header.jsp\"%\u003e\r\n\u003cdiv class=\"jumbotron jumbotron-fluid\"\u003e\r\n    \u003cdiv class=\"container\"\u003e\r\n        \u003ch1 class=\"display-4\"\u003eJava Web Application with Embedded Tomcat\u003c/h1\u003e\r\n        \u003cp class=\"lead\"\u003eThis is a web application in Java which runs on embedded Apache Tomcat in the form of executable JAR (not WAR), called uber/fat JAR. Other dependencies, if any, are also included.\u003c/p\u003e\r\n      \u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003cmain\u003e\r\n    \u003cdiv class=\"container\"\u003e\r\n        \u003cdiv class=\"row\"\u003e\r\n            \u003cdiv class=\"col\"\u003e\r\n                \u003ctable class=\"table table-hover\"\u003e\r\n                    \u003cthead\u003e\r\n                        \u003ctr\u003e\r\n                            \u003cth scope=\"col\"\u003eID\u003c/th\u003e\r\n                              \u003cth scope=\"col\"\u003eTitle\u003c/th\u003e\r\n                              \u003cth scope=\"col\"\u003eEdition\u003c/th\u003e\r\n                              \u003cth scope=\"col\"\u003eAction\u003c/th\u003e\r\n                        \u003c/tr\u003e\r\n                    \u003c/thead\u003e\r\n                      \u003ctbody\u003e\r\n                          \u003cc:forEach var=\"book\" items=\"${books}\"\u003e\r\n                        \u003ctr\u003e\r\n                              \u003cth scope=\"row\"\u003e${book.id}\u003c/th\u003e\r\n                              \u003ctd\u003e${book.title}\u003c/td\u003e\r\n                              \u003ctd\u003e${book.edition}\u003c/td\u003e\r\n                              \u003ctd\u003e\r\n                                  \u003cdiv class=\"btn-group\" role=\"group\" aria-label=\"Basic example\"\u003e\r\n                                    \u003cbutton type=\"button\" class=\"btn btn-info\" data-toggle=\"modal\" data-target=\"#bookModal\" data-book-action=\"viewBook\" data-book-id=\"${book.id}\"\u003eView\u003c/button\u003e\r\n                                \u003c/div\u003e\r\n                              \u003c/td\u003e\r\n                        \u003c/tr\u003e\r\n                        \u003c/c:forEach\u003e\r\n                      \u003c/tbody\u003e\r\n                \u003c/table\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n    \u003c/div\u003e\r\n\u003c/main\u003e\r\n\u003c%@ include file=\"/WEB-INF/templates/components/bookModal.jsp\"%\u003e\r\n\u003c%@ include file=\"/WEB-INF/templates/components/viewBookTable.jsp\"%\u003e\r\n\u003c%@ include file=\"/WEB-INF/templates/includes/footer.jsp\"%\u003e\r\n```\r\n\r\n#### Default Page\r\n\r\n##### `index.jsp`\r\n\r\nThis is the default page in our application if we access [http://localhost:8080/app](http://localhost:8080/app).\r\n\r\nRemember the **_index.jsp_** that we created earlier to test our application? We just need to modify that file.\r\n\r\n```markup\r\n\u003cjsp:include page=\"/WEB-INF/templates/includes/header.jsp\"\u003e\r\n    \u003cjsp:param value=\"Home\" name=\"pageName\"/\u003e\r\n\u003c/jsp:include\u003e\r\n        \u003cdiv class=\"jumbotron jumbotron-fluid\"\u003e\r\n            \u003cdiv class=\"container\"\u003e\r\n                \u003ch1 class=\"display-4\"\u003eJava Web Application with Embedded Tomcat\u003c/h1\u003e\r\n                \u003cp class=\"lead\"\u003eThis is a web application in Java which runs on embedded Apache Tomcat in the form of executable JAR (not WAR), called uber/fat JAR. Other dependencies, if any, are also included.\u003c/p\u003e\r\n                \u003ca type=\"button\" class=\"btn btn-primary btn-lg\" href=\"${pageContext.request.contextPath}/books\" alt=\"Books\"\u003eBooks\u003c/a\u003e\r\n            \u003c/div\u003e\r\n        \u003c/div\u003e\r\n\u003c%@ include file=\"/WEB-INF/templates/includes/footer.jsp\"%\u003e\r\n```\r\n\r\n#### Static Files\r\n\r\nOur pages will make use of JavaScript and CSS. It includes Bootstrap CSS framework, hence, the need to import them.\r\n\r\nLet's create **_assets_** folder under **_/webapp_**. Under this new folder, we'll create three (3) folders - **_css_**, **_js_**, and **_vendor_**.\r\n\r\nOur custom styling and JavaScript files will, obviously, be put inside **_css_** and **_js_** folders, respectively, while the third-party ones, Bootstrap, jQuery, Popper.js, will be in **_vendor_** folder.\r\n\r\nThe new structure of our Maven project:\r\n\r\n```\r\njava-web-app-with-embedded-tomcat\r\n└── src\r\n    └── main\r\n        └── java\r\n            └── io\r\n                └── github\r\n                    └── julianjupiter\r\n                        └── app\r\n                            └── controller\r\n                            └── domain\r\n                            └── repository\r\n                            └── server\r\n                            └── service\r\n                            └── util\r\n        └── resources\r\n        └── webapp\r\n            └── assets\r\n                └── css\r\n                └── js\r\n                └── vendor\r\n            └── WEB-INF\r\n                └── templates\r\n                    └── book\r\n                    └── components\r\n                    └── error\r\n                    └── includes\r\n└── pom.xml\r\n```\r\n\r\n###### `css`\r\n\r\n###### `main.css`\r\n\r\n```css\r\n.table-responsive {\r\n  display: table;\r\n}\r\n```\r\n\r\n##### `js`\r\n\r\n###### `main.js`\r\n\r\n```javascript\r\nlet modalTitle = $(\".modal-title\");\r\nlet modalBody = $(\".modal-body\");\r\nlet modalFooter = $(\".modal-footer\");\r\nlet closeBookModal = $(\r\n  '\u003cbutton id=\"close-book-modal\" type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\"\u003eClose\u003c/button\u003e'\r\n);\r\n\r\nfunction viewBook(bookModal, bookId) {\r\n  let viewBookTableHidden = $(\"#viewBookTable:hidden\");\r\n  $(bookModal).find(modalTitle).text(\"View Book\");\r\n  $(bookModal).find(modalBody).html(viewBookTableHidden.clone());\r\n  let viewBookTable = $(\"#viewBookTable\");\r\n  $(bookModal).find(viewBookTable).css(\"display\", \"block\");\r\n  $(bookModal).find(modalFooter).append(closeBookModal);\r\n\r\n  fetch(\"books?action=view\u0026id=\" + bookId)\r\n    .then((response) =\u003e ({ status: response.status, data: response.json() }))\r\n    .then((response) =\u003e {\r\n      if (response.status == 200) {\r\n        response.data.then((value) =\u003e {\r\n          $(bookModal).find(\"#bookId\").text(value.id);\r\n          $(bookModal).find(\"#bookTitle\").text(value.title);\r\n          $(bookModal).find(\"#bookEdition\").text(value.edition);\r\n          $(bookModal).find(\"#bookIsbn\").text(value.isbn);\r\n          $(bookModal).find(\"#bookAuthor\").text(value.author);\r\n          $(bookModal).find(\"#bookYearPublished\").text(value.yearPublished);\r\n        });\r\n      } else if (response.status == 404) {\r\n        response.data.then((value) =\u003e {\r\n          $(bookModal).find(\".modal-body\").html(value.message);\r\n        });\r\n      } else {\r\n        $(bookModal)\r\n          .find(\".modal-body\")\r\n          .html(\"An unknown error occurred. Please contact Administrator.\");\r\n      }\r\n    })\r\n    .catch((error) =\u003e {\r\n      console.log(\"Request failed\", error);\r\n      $(bookModal)\r\n        .find(\".modal-body\")\r\n        .html(\"An unknown error occurred. Please contact Administrator.\");\r\n    });\r\n}\r\n\r\nfunction clearModal(modal) {\r\n  $(modal).find(modalTitle).html(\"\");\r\n  $(modal).find(modalBody).html(\"\");\r\n  $(modal).find(modalFooter).html(\"\");\r\n}\r\n\r\n$(document).ready(() =\u003e {\r\n  $(\"#bookModal\")\r\n    .on(\"show.bs.modal\", function (event) {\r\n      var bookModal = $(this);\r\n      var button = $(event.relatedTarget);\r\n      var bookAction = button.data(\"book-action\");\r\n      var bookId = button.data(\"book-id\");\r\n\r\n      switch (bookAction) {\r\n        case \"addBook\":\r\n          addBook(bookModal);\r\n          break;\r\n\r\n        case \"viewBook\":\r\n          viewBook(this, bookId);\r\n          break;\r\n      }\r\n    })\r\n    .on(\"hidden.bs.modal\", function (event) {\r\n      clearModal(this);\r\n    });\r\n});\r\n```\r\n\r\n##### `vendor`\r\n\r\nFor the [Bootstrap](https://getbootstrap.com \"Bootstrap · The most popular HTML, CSS, and JS library in the world.\"), [jQuery](https://jquery.com/ \"jQuery\"), and [Popper.js](https://popper.js.org/ \"Popper - Tooltip \u0026 Popover Positioning Engine\"), you can download them from their respective sites.\r\n\r\nCheck **_header.jsp_** and **_footer.jsp_** files how these frameworks/libraries structured in our project.\r\n\r\n#### Re-build and Run our Application\r\n\r\nRun the following commands and open [http://localhost:8080/app](http://localhost/app) in our browser.\r\n\r\n```bash\r\n$ mvn clean package\r\n$ java -jar ./target/java-web-app-with-embedded-tomcat-1.0.0-SNAPSHOT.jar\r\n```\r\n\r\n#### Screenshots\r\n\r\n##### Home Page\r\n\r\n\u003cbr\u003e\r\n\u003cimg class=\"img-fluid\" src=\"/assets/blog/java-web-application-with-embedded-tomcat/2.PNG\"\u003e\r\n\u003cbr\u003e\r\n\u003cbr\u003e\r\n\r\n##### List of Books\r\n\r\n\u003cbr\u003e\r\n\u003cimg class=\"img-fluid\" src=\"/assets/blog/java-web-application-with-embedded-tomcat/3.PNG\"\u003e\r\n\u003cbr\u003e\r\n\u003cbr\u003e\r\n\r\n##### View a Book\r\n\r\n\u003cbr\u003e\r\n\u003cimg class=\"img-fluid\" src=\"/assets/blog/java-web-application-with-embedded-tomcat/4.PNG\"\u003e\r\n\u003cbr\u003e\r\n\u003cbr\u003e\r\n\r\n#### Conclusion\r\n\r\nWe're able to create a Servlet application in which we use Embedded Tomcat Server. We build this application into a single JAR file, called Uber or Fat JAR.\r\n\r\nWith this, we no longer need a standalone web server to deploy our application to. We achieved this mechanism by using [Maven Shade Plugin](https://maven.apache.org/plugins/maven-shade-plugin/).\r\n\r\nYou can download complete source code **[here](https://github.com/julianjupiter/java-web-app-with-embedded-tomcat \"Java Web Application with Embedded Tomcat\")**.\r\n"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"java-web-application-with-embedded-tomcat"},"buildId":"BvYN6wFifP8t4ZTtAQ_k5","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-ac8b02fa82de57111615.js"></script><script async="" data-next-page="/blog/[slug]" src="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/pages/blog/%5Bslug%5D.js"></script><script async="" data-next-page="/_app" src="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/pages/_app.js"></script><script src="/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" async=""></script><script src="/_next/static/chunks/framework.4503cc20512dbab0b6d3.js" async=""></script><script src="/_next/static/chunks/a791855beec97347770a3a58274912ffcbd97990.627b6b3615d0d2a4c6c1.js" async=""></script><script src="/_next/static/runtime/main-11312f39460057087083.js" async=""></script><script src="/_next/static/chunks/a9a7754c.29c45f57a1035e7b8fe9.js" async=""></script><script src="/_next/static/chunks/684459be936364224be479c65d3991c9c9cfced4.0b49a536fe8cdc6d5399.js" async=""></script><script src="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/_buildManifest.js" async=""></script><script src="/_next/static/BvYN6wFifP8t4ZTtAQ_k5/_ssgManifest.js" async=""></script><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script src="/assets/vendor/prismjs/prism.js"></script><script id="dsq-count-scr" src="//julianjupitergithubio.disqus.com/count.js"></script><script src="/assets/js/google_analytics.js"></script></body></html>